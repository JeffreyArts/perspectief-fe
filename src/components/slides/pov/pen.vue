<template>
    <section class="pov-content pen-container" ref="content">
        <div class="container">
            <div class="container pen" ref="container">
                <div class="pen-intro-container">
                    <p class="pen-intro">
                        <split-characters id="intro-1" class="pen-intro-section">
                            De informatie omtrent een pen bestaat uit vele verschillende data
                        </split-characters>
                        <split-characters class="pen-intro-section" id="intro-2">, van visueel zichtbare datapunten , zoals de kleur van de pen</split-characters>
                        <split-characters class="pen-intro-section" id="intro-3">, of de pen voor links- of rechtshandigen gemaakt is</split-characters>
                        <split-characters class="pen-intro-section" id="intro-4">, of wat voor type pen het is</split-characters>
                        <split-characters class="pen-intro-section" id="intro-5">. Maar ook minder expliciet zichtbare dingen behoren tot de (meta-)informatie omtrent een pen. Zo is er bijvoorbeeld een verband met papier, heeft de pen wellicht emotionele waarde, of gebruik je het voor een speciaal ritueel.</split-characters>
                    </p>

                    <div class="pen-illustration">
                        <svg viewBox="0 0 1247 367" xmlns="http://www.w3.org/2000/svg" fill="none">
                            <path class="pen-line" id="pen-line" stroke-dasharray="1244"  d="M1093 331.855C991.539 326.315 767.528 327.03 671.925 327.03C552.421 327.03 442.758 334 328.175 334C236.509 334 72.5307 331.498 2 329.175" stroke-width="3" stroke-linecap="round"/>
                            <g class="svg-pen" name="pen">
                                <path class="vulpen __isActive" d="M1109 133.9C1108.7 133.3 1108.3 132.9 1107.7 132.5C1107.5 132.4 1107.4 132.3 1107.3 132.1C1107.2 131.9 1107.2 131.7 1107.1 131.5L1104.8 16.8L1104.3 9.2C1104.2 6.9 1103.2 4.7 1101.5 3.2C1099.9 1.5 1097.7 0.599998 1095.4 0.599998H1095.2H1095C1093.7 0.599998 1092.5 0.899999 1091.3 1.4C1089.8 2.1 1088.5 3.1 1087.6 4.5C1086.7 5.8 1086.1 7.4 1086 9.1L1085.4 16.6L1081.4 131.4C1081.4 131.6 1081.3 131.8 1081.2 131.9C1081.1 132.1 1081 132.2 1080.8 132.3C1080.3 132.6 1079.8 133.1 1079.5 133.7C1079.2 134.3 1079 134.9 1079 135.5C1079 135.7 1078.4 228.2 1078.4 228.2C1078.4 228.3 1078.4 228.4 1078.5 228.5C1078.6 228.6 1078.7 228.6 1078.8 228.6C1079.1 228.6 1079.4 228.7 1079.6 228.9C1079.8 229.1 1080 229.4 1080 229.7L1080.8 242.7C1080.8 242.8 1080.8 242.9 1080.9 242.9C1081 243 1081 243 1081.1 243C1081.2 243 1081.2 243 1081.3 243L1081.4 243.1C1081.4 243.1 1081.4 243.2 1081.5 243.2C1081.5 243.3 1081.5 243.3 1081.5 243.4C1081.4 243.5 1081.4 243.7 1081.4 243.8C1081.4 244 1081.5 244.1 1081.7 244.3C1081.8 244.4 1082 244.5 1082.2 244.5L1082.7 267.2L1082.9 277.1C1082.9 277.8 1082.8 278.5 1082.5 279.2C1082.3 279.6 1082.3 280 1082.2 280.3C1082.2 280.7 1082.3 281.1 1082.4 281.5L1083 283C1083.1 283.3 1083.3 283.5 1083.6 283.7C1083.8 283.9 1084.1 284 1084.4 284H1087.6C1087.6 284 1087.5 286 1087.4 296.3C1087.3 306.6 1083.4 310.6 1085.2 312.7C1088.3 317.7 1090.1 322.3 1091.2 326C1091.9 328.4 1092.4 330.8 1092.7 333.2V333.3C1092.7 333.3 1092.7 333.3 1092.8 333.4H1093H1093.1C1093.1 333.4 1093.2 333.4 1093.2 333.3V333.2C1093.5 330.8 1094 328.4 1094.8 326C1096.3 321.4 1098.4 316.9 1101 312.8C1102.9 310.7 1099 306.7 1099 296.4C1099.1 286.1 1099 284.1 1099 284.1H1102.2C1102.5 284.1 1102.8 284 1103 283.8C1103.3 283.6 1103.4 283.4 1103.6 283.1L1104.2 281.7C1104.4 281.3 1104.4 280.9 1104.4 280.5C1104.4 280.1 1104.3 279.7 1104.2 279.3C1103.9 278.6 1103.8 277.9 1103.8 277.2L1104.1 267.3L1104.9 244.6C1105 244.6 1105.1 244.6 1105.2 244.5C1105.3 244.5 1105.4 244.4 1105.4 244.3C1105.5 244.2 1105.5 244.1 1105.6 244C1105.6 243.9 1105.7 243.8 1105.6 243.7C1105.6 243.6 1105.6 243.5 1105.5 243.4C1105.5 243.3 1105.5 243.2 1105.5 243.2C1105.5 243.1 1105.6 243.1 1105.7 243H1105.8H1105.9C1106 243 1106 242.9 1106 242.9C1106 242.8 1106.1 242.8 1106.1 242.7L1107.1 229.7C1107.1 229.4 1107.3 229.1 1107.5 228.9C1107.7 228.7 1108 228.6 1108.3 228.6C1108.4 228.6 1108.4 228.6 1108.5 228.6C1108.6 228.6 1108.6 228.5 1108.7 228.5C1108.7 228.4 1108.8 228.4 1108.8 228.3L1109.5 135.6C1109.5 135.1 1109.3 134.5 1109 133.9Z"/>
                                <path class="balpen" d="M1108 135.1C1108 134.5 1107.8 133.8 1107.5 133.3C1107.2 132.7 1106.8 132.3 1106.2 131.9C1106 131.8 1105.9 131.7 1105.8 131.5C1105.7 131.3 1105.7 131.1 1105.6 131L1102.5 17.5L1101.5 3.6C1101.5 3.5 1101.4 3.3 1101.3 3.2C1101.1 3.1 1101 3 1101 2.9C1099.9 2.5 1096.9 1.6 1092.9 1.6C1088.8 1.6 1085.9 2.5 1084.8 2.9C1084.6 3 1084.6 3 1084.4 3.2C1084.2 3.3 1084.2 3.4 1084.2 3.6L1083.2 17.5L1080.2 131C1080.2 131.2 1080.1 131.4 1080 131.5C1079.9 131.7 1079.8 131.8 1079.6 131.9C1079.1 132.2 1078.6 132.7 1078.3 133.3C1078 133.9 1077.8 134.5 1077.8 135.1C1077.8 135.3 1077.9 226.7 1077.9 226.7C1077.9 226.8 1077.9 226.9 1078 227C1078.1 227.1 1078.2 227.1 1078.3 227.1C1078.6 227.1 1078.9 227.2 1079.1 227.4C1079.3 227.6 1079.5 227.9 1079.5 228.2L1080.4 241.1C1080.4 241.2 1080.4 241.3 1080.5 241.3C1080.6 241.4 1080.6 241.4 1080.7 241.4C1080.8 241.4 1080.8 241.4 1080.9 241.4L1081 241.5C1081 241.5 1081 241.6 1081.1 241.6C1081.1 241.7 1081.1 241.7 1081.1 241.8C1081 241.9 1081 242.1 1081 242.2C1081 242.4 1081.1 242.5 1081.3 242.7C1081.4 242.8 1081.6 242.9 1081.8 242.9L1082.4 265.4L1082.8 269C1082.9 269 1082.9 269 1083 269.1C1083.1 269.1 1083.1 269.2 1083.1 269.3C1083.1 269.4 1083.1 269.4 1083.1 269.5C1083.1 269.6 1083 269.6 1083 269.6L1083.4 273.5C1083.5 273.5 1083.5 273.5 1083.6 273.6C1083.7 273.6 1083.7 273.7 1083.7 273.8C1083.7 273.9 1083.7 273.9 1083.7 274C1083.7 274.1 1083.6 274.1 1083.6 274.1C1083.6 274.1 1083.6 274.1 1083.5 274.1L1083.9 278C1084 278 1084 278 1084.1 278.1C1084.2 278.1 1084.2 278.2 1084.2 278.3C1084.2 278.4 1084.2 278.4 1084.1 278.5C1084.1 278.6 1084 278.6 1083.9 278.6L1088.6 322.9C1088.6 323.1 1088.7 323.3 1088.8 323.4C1088.9 323.5 1089.1 323.6 1089.3 323.6H1090V325.5C1090 325.8 1090 326 1090.1 326.3L1091.8 331.8C1091.9 332.1 1092.1 332.3 1092.4 332.5C1092.7 332.7 1092.9 332.7 1093.2 332.7C1093.4 332.7 1093.6 332.7 1093.8 332.6C1094.1 332.5 1094.4 332.2 1094.6 331.8L1096.3 326.3C1096.4 326 1096.4 325.8 1096.4 325.5V323.6H1097.1C1097.2 323.6 1097.3 323.6 1097.4 323.5C1097.5 323.4 1097.6 323.4 1097.7 323.3C1097.8 323.2 1097.8 323.1 1097.8 322.9L1102.4 278.6C1102.3 278.6 1102.3 278.6 1102.2 278.5C1102.2 278.5 1102.1 278.4 1102.1 278.3C1102.1 278.2 1102.1 278.2 1102.1 278.1C1102.1 278 1102.2 278 1102.2 278H1102.3L1102.7 274.1C1102.6 274.1 1102.6 274.1 1102.5 274C1102.5 274 1102.4 273.9 1102.4 273.8C1102.4 273.7 1102.4 273.7 1102.4 273.6C1102.4 273.5 1102.5 273.5 1102.5 273.5H1102.6L1103 269.6C1102.9 269.6 1102.9 269.6 1102.8 269.5C1102.8 269.4 1102.7 269.4 1102.7 269.3C1102.7 269.2 1102.7 269.2 1102.8 269.1C1102.9 269 1102.9 269 1103 269L1103.4 265.4L1104 242.9H1104.1C1104.3 242.8 1104.7 242.6 1104.8 242.3C1104.8 242.2 1104.8 242 1104.7 241.9V241.8V241.7C1104.7 241.7 1104.7 241.6 1104.8 241.6L1104.9 241.5H1105C1105.1 241.5 1105.1 241.4 1105.1 241.4C1105.1 241.3 1105.2 241.3 1105.2 241.2L1106 228.3C1106 228.1 1106.1 227.9 1106.2 227.7C1106.3 227.5 1106.5 227.4 1106.7 227.3C1106.9 227.2 1107 227.2 1107.2 227.2C1107.3 227.2 1107.3 227.2 1107.3 227.2C1107.4 227.2 1107.4 227.1 1107.5 227.1C1107.5 227 1107.6 227 1107.6 226.9C1108 226.8 1108 135.3 1108 135.1Z"/>
                            </g>
                        </svg>
                    </div>
                </div>
                


                    
                    <div class="pen-text-container">
                        <p>
                            Jouw standpunt is daarom relevant bij de kennisvorming over een pen. 
                            Misschien vind jij de kleur zeer belangrijk, of vind je het idee van een pen met emotionele waarde onnozele onzin. 
                            Het standpunt in relatie tot de pen is dan ook voor de ene persoon anders dan de ander.
                        </p>
                        <p>
                            Zo ontstaat bij mij tijdens het schrijven van deze tekst over een pen, 
                            de correlatie met de film: the Wolf of Wallstreet. 
                            Deze film sluit af met een presentatie van de hoofdrolspeler Jordan Belfort, 
                            waarin hij de vraag: “kun je mij deze pen verkopen?” stelt aan zijn publiek.
                        </p>
                        <p>
                            In de film komt er geen antwoord op deze vraag, 
                            maar in een interview legt hij uit dat het erom gaat dat je als verkoper wilt weten 
                            wat de potentiële klant belangrijk vind, waar hecht deze waarde aan. 
                            Met andere woorden, wat is zijn of haar standpunt?
                        </p>
                    </div>

                    <div class="pen-text-footer">
                        <p>
                            Dit standpunt wordt gevormd door allerlei verschillende (meta-)informatie, 
                            maar het is vooral belangrijk om even uit te zoomen en je te realiseren dat wat een pen voor jou waard is, 
                            niets te maken heeft met de waarde van de pen zelf.
                        </p>
                    </div>
            </div>
        </div>
                    
                
        <div class="pen-slide-end">
            <FadeText @animationComplete="isCompleted">
                Simpel gezegd, wanneer je in je leven alleen maar blauwe pennen hebt gezien, 
                dan zul je een niet blauwe pen al snel als iets bijzonders zien. 
                Maar dat betekend dus niet dat niet-blauwe pennen op zichzelf bijzonder zijn…
            </FadeText>
        </div>
    </section>
</template>


<script lang="ts">
import { defineComponent } from "vue"
import isMobiel from "@/stores/is-mobile"
import gsap from "gsap"
import { MorphSVGPlugin } from "gsap/MorphSVGPlugin"
import { MotionPathPlugin } from "gsap/MotionPathPlugin"
import { ScrollTrigger } from "gsap/ScrollTrigger"
import { GSDevTools } from "gsap/GSDevTools"
import FadeText from "@/components/fade-text.vue"
import SplitCharacters from "@/components/split-characters.vue"
import _ from "lodash"


export default defineComponent({
    name: "pov-pen",
    components: {
        FadeText, SplitCharacters
    },
    setup() {
        const isMobile = isMobiel()
        return { isMobile }
    },
    data: () => {
        return {
            timeline: null as null | gsap.core.Timeline,
        }
    },
    mounted() {
        // gsap.registerPlugin(GSDevTools)
        gsap.registerPlugin(MotionPathPlugin)
        
        setTimeout(() => {
            // GSDevTools.create()
            this.initialiseAnimation()
        }, 0)
    },
    unmounted() {
        if (this.timeline) {
            this.timeline.pause()
            this.timeline.kill()
        }
    },
    methods: {
        isCompleted() {
            this.$emit("completed")
        },
        initialiseAnimation() {
            // SET DEFAULTS
            gsap.set(".pen-intro-section .character", {opacity: 0})
            gsap.set(".svg-pen", {x: -1244})
            gsap.set(".pen-line", {strokeDashoffset: -1244, stroke: "#555",})
            gsap.set(".pen-text-container p", {opacity: 0})
            gsap.set(".pen-text-footer", {opacity: 0})
            ScrollTrigger.defaults({
                scroller: ".pov-page",
            })
            

            
            this.timeline = gsap.timeline({
                defaults: {
                    duration: .64,
                    ease: "power2.out"
                },
                scrollTrigger:{
                    trigger: ".pen-intro-container", // start the animation when ".box" enters the viewport (once)
                    // markers: true,
                    id:"intro",
                    start: this.isMobile.v ? "top 20%" : "top 50%",
                }})
                .to(this.$el.querySelectorAll(".svg-pen"), {
                    x: 0,
                    duration: 1.024,
                    motionPath: {
                        path: "#pen-line",
                        alignOrigin: [.4, 1],
                        start:1,
                        end:0,
                        align: "#pen-line",
                    },
                })
                .to(this.$el.querySelectorAll(".pen-line"), {
                    strokeDashoffset: 0,
                    delay: -1.024,
                    duration: 1,
                })
                .fromTo(this.$el.querySelectorAll(".svg-pen"),{
                    rotation: 32,

                },{ 
                    rotation: 24,
                    duration: 0.96,
                    ease: "power1.inOut",
                    delay: -1.024
                })
                .to(this.$el.querySelectorAll(".svg-pen"), {
                    rotate: 20,
                    duration: .8,
                    delay: -.48,
                    ease: "ease.out"
                })
                .to(this.$el.querySelectorAll("#intro-1 .character"), {
                    opacity: 1,
                    stagger: 0.016,
                })
                .to(this.$el.querySelectorAll("#intro-2 .character"), {
                    opacity: 1,
                    stagger: 0.016,
                })
                .to(this.$el.querySelectorAll(".pen-line"), {
                    stroke: "#2278EB",
                    delay: 0.48,
                    duration: 0.8,
                })
                .to(this.$el.querySelectorAll("#intro-3 .character"), {
                    opacity: 1,
                    stagger: 0.016,
                })
                .fromTo(this.$el.querySelectorAll(".svg-pen"),{
                    rotation: 24,
                },{ 
                    rotation: -24,
                    duration: 0.96,
                    delay: -0.16,
                    ease: "circ.out"
                })
                .to(this.$el.querySelectorAll(".pen-illustration"),{
                    delay: -0.96,
                    duration: 0.96,
                    x: 128,
                    ease: "circ.out"
                })
                .to(this.$el.querySelectorAll("#intro-4 .character"), {
                    opacity: 1,
                    stagger: 0.016,
                })
                .to(this.$el.querySelectorAll(".__isActive"), {
                    morphSVG: {shape: ".balpen"}, 
                    // delay: 0.32,
                    duration: 1.6,
                    ease: "bounce.out",
                })
                .to(this.$el.querySelectorAll("#intro-5 .character"), {
                    opacity: 1,
                    stagger: 0.01,
                })
                .to(this.$el.querySelectorAll("#intro-5 .character"), {
                    opacity: 1,
                    delay: 0.16,
                })
                .to(this.$el.querySelectorAll(".pen-text-container p"), {
                    opacity: 1,
                    stagger: .64,
                })
            
            gsap.to(".pen-text-footer", {
                scrollTrigger:{
                    trigger: ".pen-text-footer", // start the animation when ".box" enters the viewport (once)
                    // markers: true,
                    id:"footer",
                    start: "top 80%",
                },
                opacity: 1,
            })
        }
    }

})
</script>

<style lang="scss">
@import "@/assets/scss/variables.scss";


.pen-intro-container {
    display: flex;
    flex-direction: column-reverse;
    position: relative;
    margin-top: -32px;
    
    @media (min-width: 768px) {
        margin-top: 0;
        flex-direction: row;
        flex-wrap: nowrap;
        align-items: center;
        min-height: 320px;
    }
}

.pen-intro {
    margin-top: 344px;
    
    @media (min-width: 768px) {
        width: calc(100% - 320px);
        line-height: 2.4;
        margin-top: 0;
    }
}

.svg-pen {
    fill: transparent;

    .__isActive {
        stroke: #333;
        stroke-width: 1.6px;
    }
}

.pen-line {
    stroke: $blue;
}

// .svg-pen {
//     margin-bottom: 16px;
// }

// .svg-pen-line {
//     stroke: #333;
// }

.pen-illustration {
    position: relative;
    
    svg {
        width: 1024px;
        position: absolute;
        right: 0;
        top: 32px;
    }
    @media (min-width: 768px) {
        position: absolute;
        bottom: 0;
        top: auto;
        width: calc(100% + 128px);
        right: 64px;
        
        svg {
            margin-top: 32px;
            width: 100%;
            position: absolute;
            right: 0;
            translate: 0 -100%;
            // left: 0;
        }
    }

    @media (min-width: 1024px) {
    }
}

.pen-intro-section {
    display: inline;
}

.pen-text-container {
    display: flex;
    flex-direction: column;
    p {
        margin: 16px 0 0;
    }

    
    @media (min-width: 768px) {
        p {
            margin: 64px 0 0;
        }
        flex-direction: row;
        gap: 40px;
        text-align: justify;
        
        font-size: 14px;
        line-height: 24px;
    }
    @media (min-width: 1024px) {
        gap: 80px;
        font-size: 16px;
        line-height: 32px;
    }
}
.pen-text-footer {
    display: flex;
    justify-content: center;
    align-items: center;

    p {
        margin: 32px 0 0;
    }

    @media (min-width: 768px) {
        margin: 48px;
        text-align: center;
    }

}


.pen-slide-end {
    display: flex;
    justify-content: center;
    height: 100vh;

    p {
        display: block;
        margin: auto;
        font-size: 18px;
        max-width: 80%;
        text-align: center;
    }
    
}
</style>
